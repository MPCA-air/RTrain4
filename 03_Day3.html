<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>R Training | Day 3</title>

<script src="03_Day3_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="03_Day3_files/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="03_Day3_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="03_Day3_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="03_Day3_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="03_Day3_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="03_Day3_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="03_Day3_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="03_Day3_files/navigation-1.1/tabsets.js"></script>
<link href="03_Day3_files/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="03_Day3_files/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="css\camp_style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R Training | Day 3</h1>

</div>


<div id="welcome-back-jedis" class="section level1 unnumbered">
<h1>Welcome back Jedis!</h1>
<hr>
<div class="figure">
<img src="images/day3_sq.png" style="float: left; margin-right: 60px; margin-top: 8px;" width="260" />

</div>
<p><br></p>
<div id="please-connect-to-your-droid" class="section level3 unnumbered">
<h3>Please connect to your droid</h3>
<ul>
<li>Open the <strong>Start menu</strong> (<em>Click the Windows logo on the bottom left of the screen</em>)</li>
<li>Select <code>Remote Desktop Connection</code></li>
<li>Enter <code>R32-your7digit#</code> or <code>w7-your7digit#</code></li>
<li>Press <em>Connect</em></li>
</ul>
<p><br></p>
<p><strong>Open your RStudio project</strong></p>
<ul>
<li><strong>Open</strong> your project folder from last week</li>
<li>Double click the <strong>.Rproj</strong> file to open RStudio</li>
</ul>
<p><strong>Open a New script</strong></p>
<ul>
<li><p><strong>File &gt; New File &gt; R Script</strong></p></li>
<li>Click the <em>floppy disk</em> save icon</li>
<li><p>Give it a name: <code>03_day.R</code> or <code>jakku_plots.R</code> will work well</p></li>
</ul>
</div>
<div id="schedule" class="section level2 unnumbered">
<h2>Schedule</h2>
<div class="well">
<ul>
<li>Review</li>
<li>Where’s Finn?</li>
<li>Join 2 tables</li>
<li>Conditional mutate!
<ul>
<li><code>ifelse()</code></li>
<li>Yes/No decisions</li>
</ul></li>
<li>Summarize by group</li>
<li>More plots
<ul>
<li>New geoms</li>
<li>Reference lines</li>
<li>Faceting</li>
<li>Colors</li>
<li>Titles</li>
</ul></li>
</ul>
</div>
</div>
<div id="porg-review" class="section level2 unnumbered">
<h2>Porg review</h2>
<p>The <em>poggle</em> of porgs has returned to help us review the <code>dplyr</code> functions. Follow along by downloading the <strong>porg</strong> data from the URL below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
porgs &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/porg_data.csv&quot;</span>)</code></pre></div>
<p><br></p>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="porgs-tab" data-toggle="tab" href="#porgs" role="tab" aria-controls="porgs" aria-selected="true"> porgs </a>
</li>
<li class="nav-item">
<a class="nav-link" id="select-tab" data-toggle="tab" href="#select" role="tab" aria-controls="select" aria-selected="false"> <code>select</code> </a>
</li>
<li class="nav-item">
<a class="nav-link" id="arrange-tab" data-toggle="tab" href="#arrange" role="tab" aria-controls="arrange" aria-selected="false"> <code>arrange</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="filter-tab" data-toggle="tab" href="#filter" role="tab" aria-controls="filter" aria-selected="false"> <code>filter</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="mutate3-tab" data-toggle="tab" href="#mutate3" role="tab" aria-controls="mutate3" aria-selected="false"> <code>mutate</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="summarize-tab" data-toggle="tab" href="#summarize" role="tab" aria-controls="summarize" aria-selected="false"> <code>summarize</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="group_by-tab" data-toggle="tab" href="#group_by" role="tab" aria-controls="group_by" aria-selected="false"> <code>group_by</code></a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="porgs" class="tab-pane fade active in" role="tabpanel" aria-labelledby="porgs-tab">
<img src="images/porgs/porgs_tbl.png" style="width: 85%;" /> <br><br>
</div>
<div id="select" class="tab-pane fade" role="tabpanel" aria-labelledby="select-tab">
<img src="images/porgs/select_card.png" style="width: 90%;" /> <br><br> <img src="images/porgs/select_drop.png" style="width: 65%;" /> <img src="images/porgs/select_drop_tbl.png" style="width: 80%; margin-left: 5%; margin-top: 12px;" /> <br><br>
</div>
<div id="arrange" class="tab-pane fade" role="tabpanel" aria-labelledby="arrange-tab">
<img src="images/porgs/arrange.png" style="width: 65%;" /> <img src="images/porgs/arrange_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br> <img src="images/porgs/arrange_desc.png" style="width: 57%;" /> <img src="images/porgs/arrange_tbl_desc.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br>
</div>
<div id="filter" class="tab-pane fade" role="tabpanel" aria-labelledby="filter-tab">
<img src="images/porgs/filter.png" style="width: 65%;" /> <img src="images/porgs/filter_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br> <img src="images/porgs/filter2.png" style="width: 75%;" /> <img src="images/porgs/filter2_tbl.png" style="width: 88%; margin-left: 10%; margin-top: 12px;" /> <br><br>
</div>
<div id="mutate3" class="tab-pane fade" role="tabpanel" aria-labelledby="mutate3-tab">
<img src="images/porgs/mutate_card.png" style="width: 88%;" /> <br><br>
</div>
<div id="summarize" class="tab-pane fade" role="tabpanel" aria-labelledby="summarize-tab">
<img src="images/porgs/summarize_card.png" style="width: 88%;" /> <br><br>
</div>
<div id="group_by" class="tab-pane fade" role="tabpanel" aria-labelledby="group_by-tab">
<img src="images/porgs/groupby_card.png" style="width: 92%;" /> <br><br>
</div>
</div>
<p><br></p>
<p><strong>So where were we? Oh right, we we’re enjoying our time on beautiful lush Endor. But aren’t we missing somebody?</strong></p>
</div>
</div>
<div id="finn-needs-us" class="section level1 unnumbered">
<h1>| Finn needs us!</h1>
<p>That’s enough <em>scuttlebutting</em> around on Endor, Finn needs us back on Jakku. It turns out we forgot to pick-up Finn when we left. Now he’s being held ransom by Junk Boss Plutt. We’ll need to act fast to get to him before the Empire does. <strong>Blast off!</strong></p>
<p><br></p>
<div class="figure">
<img src="images/finn_run.gif" style="margin-left: 18%; width: 60%; margin-top: 6px;" />

</div>
<p><br></p>
</div>
<div id="more-data" class="section level1 unnumbered">
<h1>More data</h1>
<div class="tip">
<h3 style="margin-top: 13px;">
Update from BB8!
</h3>
<p>BB8 was busy on our flight back to Jakku, and was able to recover a <strong>full</strong> set of scrap records from the notorious Unkar Plutt. Let’s take a look.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(dplyr)

<span class="co"># Read in the full scrap database</span>
scrap &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://itep-r.netlify.com/data/starwars_scrap_jakku_full.csv&quot;</span>)</code></pre></div>
</div>
<p><br></p>
</div>
<div id="jakku-re-visited" class="section level1">
<h1><span class="header-section-number">1</span> | Jakku re-visited</h1>
<hr>
<p>Okay, so we’re back on the ol’ dust bucket. Let’s try not to forget anything while were here this time. We’re quickly running out of friends on this planet.</p>
<div id="a-scrappy-ransom" class="section level2 unnumbered">
<h2>A scrappy ransom</h2>
<p>Mr. Baddy Plutt is demanding <strong>10,000 items</strong> of scrap for Finn. Sounds expensive, but lucky for us he didn’t clarify the exact items. Let’s find the scrap that weighs the least per shipment and try to make this transaction as light as possible.</p>
<p>Take a look at our <strong>NEW</strong> scrap data and see if we have the weight of all the items.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># What unit types are in the data?</span>
<span class="kw">unique</span>(scrap<span class="op">$</span>units)</code></pre></div>
<pre><code>## [1] &quot;Cubic Yards&quot; &quot;Items&quot;       &quot;Tons&quot;</code></pre>
<p><strong>Or return results as a data frame</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">distinct</span>(scrap, units)</code></pre></div>
<pre><code>## # A tibble: 3 x 1
##   units      
##   &lt;chr&gt;      
## 1 Cubic Yards
## 2 Items      
## 3 Tons</code></pre>
<p><br></p>
<p><em>Hmmm….</em> So how much does a cubic yard of <code>Hull Panel</code> weigh?</p>
<p><em>A lot? 32? Maybe…</em></p>
<p>I think we’re going to need some more data.</p>
<p><br></p>
<div class="tip">
<p><strong>“Hey BB8!”</strong></p>
<p><strong>“Please do your magic data finding thing.”</strong></p>
</div>
</div>
<div id="get-the-weights" class="section level2 unnumbered">
<h2>Get the weights</h2>
<div class="figure">
<img src="images/rey_bb8.jpg" align="right" style="width: 35%; margin-top: 0px; margin-left: 15px; margin-right: 0px;" />

</div>
<p>It took a while, but with a few droid bribes BB8 was able to track down a <em>Weight conversion table</em> from his old droid buddies. Our current data shows the total cubic yards for some scrap shipments, but not how much the shipment weighs.</p>
<div id="read-the-weight-conversion-table" class="section level3 unnumbered">
<h3>Read the weight conversion table</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The data&#39;s URL</span>
convert_url &lt;-<span class="st"> &quot;https://rtrain.netlify.com/data/conversion_table.csv&quot;</span>

<span class="co"># Read the conversion data</span>
convert &lt;-<span class="st"> </span><span class="kw">read_csv</span>(convert_url)

<span class="kw">head</span>(convert, <span class="dv">3</span>)</code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   item               units       pounds_per_unit
##   &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
## 1 Bulkhead           Cubic Yards             321
## 2 Hull Panel         Cubic Yards             641
## 3 Repulsorlift array Cubic Yards             467</code></pre>
<p><br></p>
<p>Stars! A cubic yard of <code>Hull Panel</code> weighs <strong>641 lbs</strong>. That’s what I thought!</p>
<p>Let’s join this new conversion table to the scrap data to make our calculations easier. To do that we need to make a new friend.</p>
<p><strong>Say “Hello” to <code>left_join()</code>!</strong></p>
</div>
</div>
</div>
<div id="join-tables" class="section level1">
<h1><span class="header-section-number">2</span> | Join tables</h1>
<div class="figure">
<img src="images/leftjoin_scrap.png" style="width: 55%; margin-left: 18%;" />

</div>
<br><br>
<hr>
<p><code>left_join()</code> works like a zipper and combines two tables based on one or more variables. It’s called “left”-join because the entire table on the left side is retained. Anything that matches from the right table gets to join the party, but the rest will be ignored.</p>
<div id="join-2-tables" class="section level2 unnumbered">
<h2>Join 2 tables</h2>
<div id="left_jointable1-table2-by-ccolumns-to-join-by" class="section level3 unnumbered">
<h3><code>left_join(table1, table2, by = c(&quot;columns to join by&quot;))</code></h3>
<p><br></p>
</div>
<div id="adding-porg-names" class="section level3 unnumbered">
<h3>Adding porg names</h3>
<p>Remember our porg friends? How rude of us not to share their names. <strong>Wups!</strong></p>
<p>Here they are:</p>
<div style="margin-left: 10px; margin-top: 24px; width: 37%; margin-bottom: 34px;">
<div class="figure">
<img src="images/porgs/porg_names_tbl.png" />

</div>
</div>
<div style="clear: both;">

</div>
<p><strong>Hey now!</strong> That’s not very helpful. Who’s who? Let’s join their names to the rest their data.</p>
<p><br></p>
<div class="figure">
<img src="images/porgs/porg_join.png" style="width: 85%;" />

</div>
<p><br></p>
</div>
<div id="the-result" class="section level3 unnumbered">
<h3><strong>The result</strong></h3>
<div class="well">
<div class="figure">
<img src="images/porgs/porgs_and_names.png" style="width: 85%; max-width: 85%;" />

</div>
</div>
<p><br></p>
</div>
</div>
<div id="back-to-scrap-land" class="section level2 unnumbered">
<h2>Back to scrap land</h2>
<p>Let’s apply our new <code>left_join()</code> skills to the scrap data.</p>
<p><br></p>
<div id="join-the-conversion-table-to-the-scrap" class="section level3 unnumbered">
<h3>Join the conversion table to the scrap</h3>
<p>Look at the tables. What columns in both tables do we want to join <strong>by</strong>?</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scrap &lt;-<span class="st"> </span><span class="kw">left_join</span>(scrap, convert, 
                   <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;item&quot;</span> =<span class="st"> &quot;item&quot;</span>, <span class="st">&quot;units&quot;</span> =<span class="st"> &quot;units&quot;</span>))</code></pre></div>
<p><br></p>
<blockquote>
<p>Want to skimp on typing?</p>
</blockquote>
<p><br></p>
<p>When the 2 tables share column names that are the same, <code>left_join()</code> will automatically search for matching columns. Nice! So the code below does the same as above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scrap &lt;-<span class="st"> </span><span class="kw">left_join</span>(scrap, convert)

<span class="kw">head</span>(scrap, <span class="dv">4</span>)</code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   receipt_date item  origin destination amount units price_per_pound
##   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
## 1 4/1/2013     Bulk~ Crate~ Raiders       4017 Cubi~           1005.
## 2 4/2/2013     Star~ Outsk~ Trade cara~   1249 Cubi~           1129.
## 3 4/3/2013     Star~ Outsk~ Niima Outp~   4434 Cubi~           1129.
## 4 4/4/2013     Hull~ Crate~ Raiders        286 Cubi~            843.
## # ... with 1 more variable: pounds_per_unit &lt;dbl&gt;</code></pre>
<p><br></p>
<p><strong>Want more details?</strong></p>
<p>You can type <code>?left_join</code> to see all the arguments and options.</p>
<p><br></p>
</div>
</div>
<div id="total-pounds-per-shipment" class="section level2 unnumbered">
<h2>Total pounds per shipment</h2>
<p>Let’s mutate!</p>
<p>Now that we have pounds per unit we can use <code>mutate</code> to calculate the total pounds for each shipment.</p>
<p><br></p>
<p><strong>Fill in the blank</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scrap &lt;-<span class="st"> </span>scrap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">total_pounds =</span> amount <span class="op">*</span><span class="st">  </span>_____________ )</code></pre></div>
<details> <summary class = "btn_code"><em>Show code</em></summary>
<p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scrap &lt;-<span class="st"> </span>scrap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">total_pounds =</span> amount <span class="op">*</span><span class="st"> </span>pounds_per_unit)</code></pre></div>
</p>
<p></details></p>
</div>
<div id="total-price-per-shipment" class="section level2 unnumbered">
<h2>Total price per shipment</h2>
<div class="note">
<h3 id="exercise" class="unnumbered"><i class="fa fa-bicycle" aria-hidden="true" style="color: green"></i> EXERCISE</h3>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="totalprice-tab" data-toggle="tab" href="#totalprice" role="tab" aria-controls="totalprice" aria-selected="true">Total price</a>
</li>
<li class="nav-item">
<a class="nav-link" id="showhint-tab" data-toggle="tab" href="#showhint" role="tab" aria-controls="showhint" aria-selected="false">Show hint</a>
</li>
<li class="nav-item">
<a class="nav-link" id="showcode-tab" data-toggle="tab" href="#showcode" role="tab" aria-controls="showcode" aria-selected="false">Show code</a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="totalprice" class="tab-pane fade active in" role="tabpanel" aria-labelledby="totalprice-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">

# Calculate the total price for each shipment
scrap <- scrap %>% 
         mutate(credits = ________ * ________ )
         
</pre>
</div>
<div id="showhint" class="tab-pane fade" role="tabpanel" aria-labelledby="showhint-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">

# Calculate the total price for each shipment
scrap <- scrap %>% 
         mutate(credits = total_pounds  * ________ )

</pre>
</div>
<div id="showcode" class="tab-pane fade" role="tabpanel" aria-labelledby="showcode-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">

# Calculate the total price for each shipment
scrap <- scrap %>% 
         mutate(credits = total_pounds * price_per_pound)
         
</pre>
</div>
</div>
</div>
<p><br></p>
</div>
<div id="price-per-item" class="section level2 unnumbered">
<h2>Price per item</h2>
<p><strong>Great!</strong> Let’s add one last column. We can divide the shipment’s <em>credits</em> by the <em>amount</em> of items to get the <code>price_per_unit</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate the price per unit</span>
scrap &lt;-<span class="st"> </span>scrap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">price_per_unit =</span> credits <span class="op">/</span><span class="st"> </span>amount)</code></pre></div>
<p><br></p>
<div class="note" style="line-height: 1.6;">
<p>Data analysts often get asked summary questions such as:</p>
<ul>
<li>What’s the highest or worst?</li>
<li>What’s the lowest number?</li>
<li>Is that worse than average?
<ul>
<li>What’s the average tonnage of scrap from Cratertown this year?</li>
</ul></li>
<li>What city is making the most money?</li>
</ul>
</div>
<div id="on-to-summarize" class="section level3 unnumbered">
<h3>On to <code>summarize()</code>!</h3>
</div>
</div>
</div>
<div id="summarize-this" class="section level1">
<h1><span class="header-section-number">3</span> | <code>summarize()</code> this!</h1>
<hr>
<div class="figure">
<img src="images/summarize_diagram.png" width="500" />

</div>
<p><code>summarize()</code> allows you to apply a summary function like <code>median()</code> to a column and collapse your data down to a single row. To really dig into <code>summarize</code> you’ll want to know some common summary functions, such as <code>sum()</code>, <code>mean()</code>, <code>median()</code>, <code>min()</code>, and <code>max()</code>.</p>
<div id="sum" class="section level2 unnumbered">
<h2><code>sum()</code></h2>
<p>Use <code>summarize()</code> and <code>sum()</code> to find the total credits of <strong>all</strong> the scrap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(scrap, <span class="dt">total_credits =</span> <span class="kw">sum</span>(credits))</code></pre></div>
</div>
<div id="mean" class="section level2 unnumbered">
<h2><code>mean()</code></h2>
<p>Use <code>summarize()</code> and <code>mean()</code> to calculate the <em>mean</em> <code>price_per_pound</code> in the scrap report.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(scrap, <span class="dt">mean_price =</span> <span class="kw">mean</span>(price_per_pound, <span class="dt">na.rm =</span> T))</code></pre></div>
<p><br></p>
<blockquote>
<p>Note the <code>na.rm = TRUE</code> in the <code>mean()</code> function. This tells R to ignore empty cells or missing values that show up in R as <code>NA</code>. If you leave <code>na.rm</code> out, the <em>mean</em> function will return ‘NA’ if it finds a missing value in the data.</p>
</blockquote>
</div>
<div id="median" class="section level2 unnumbered">
<h2><code>median()</code></h2>
<p>Use summarize to calculate the <em>median</em> price_per_pound in the scrap report.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(scrap, <span class="dt">median_price =</span> <span class="kw">median</span>(price_per_pound, <span class="dt">na.rm =</span> T))</code></pre></div>
</div>
<div id="max" class="section level2 unnumbered">
<h2><code>max()</code></h2>
<p>Use summarize to calculate the <em>maximum</em> price per pound any scrapper got for their scrap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(scrap, <span class="dt">max_price =</span> <span class="kw">max</span>(price_per_pound, <span class="dt">na.rm =</span> T))</code></pre></div>
</div>
<div id="min" class="section level2 unnumbered">
<h2><code>min()</code></h2>
<p>Use summarize to calculate the <em>minimum</em> price per pound any scrapper got for their scrap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(scrap, <span class="dt">min_price =</span> <span class="kw">min</span>(price_per_pound, <span class="dt">na.rm =</span> T))</code></pre></div>
</div>
<div id="nth" class="section level2 unnumbered">
<h2><code>nth()</code></h2>
<p>Use <code>summarize()</code> and <code>nth(Origin, 12)</code> to find the name of the Origin City that had the <em>12th</em> highest scrapper haul.</p>
<p><em>Hint: Use <code>arrange()</code> first.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">arrange</span>(scrap, <span class="kw">desc</span>(credits)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">price_12 =</span> <span class="kw">nth</span>(origin, <span class="dv">12</span>))</code></pre></div>
</div>
<div id="quantile" class="section level2 unnumbered">
<h2><code>quantile()</code></h2>
<p>Quantiles are great for finding the upper or lower range of a column. Use the <code>quantile()</code> function to find the the 5th and 95th quantile of the prices.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summarize</span>(scrap, 
          <span class="dt">price_5th_pctile  =</span> <span class="kw">quantile</span>(price_per_pound, <span class="fl">0.05</span>, <span class="dt">na.rm =</span> T),
          <span class="dt">price_95th_pctile =</span> <span class="kw">quantile</span>(price_per_pound, <span class="fl">0.95</span>))</code></pre></div>
<p><strong>Hint:</strong> Add <code>na.rm = T</code> to <code>quantile()</code>.</p>
<p><br></p>
<div class="tip">
<h3 id="exercise-1" class="unnumbered"><i class="fa fa-bicycle" aria-hidden="true" style="color: green"></i> EXERCISE</h3>
<p>Create a summary of the scrap data that includes 3 of the summary functions above. The following is one example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">summary &lt;-<span class="st"> </span>scrap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">             </span><span class="kw">summarize</span>(<span class="dt">max_credits      =</span>  __________ ,
                       <span class="dt">mean_credits     =</span>  __________ ,
                       <span class="dt">min_pounds       =</span>  __________  )</code></pre></div>
</div>
<p><br></p>
</div>
<div id="n" class="section level2 unnumbered">
<h2><code>n()</code></h2>
<p><code>n()</code> stands for <em>count</em>. It has the smallest function name I know of, but is super useful.</p>
<p>Use summarize and <code>n()</code> to count the number of reported scrap records going to <code>Niima outpost</code>.</p>
<p><br></p>
<p><strong>Hint:</strong> Use <code>filter()</code> first.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">niima_scrap &lt;-<span class="st"> </span><span class="kw">filter</span>(scrap, destination <span class="op">==</span><span class="st"> &quot;Niima Outpost&quot;</span>) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">niima_scrap &lt;-<span class="st"> </span><span class="kw">summarize</span>(niima_scrap, <span class="dt">scrap_records =</span> <span class="kw">n</span>())</code></pre></div>
<p><br></p>
<p>Ok. That was fun. Now let’s do a summary for Cratertown. And then for Blowback Town. And then for Tuanul. And then for…</p>
<p><br></p>
<div id="wait" class="section level3 unnumbered">
<h3><strong>Wait!</strong></h3>
<blockquote>
<p>Do we really need to <code>filter</code> to the <em>origin</em> city that we’re interested in every single time?</p>
<p>How about you just give me the mean price for every <em>origin</em> city. Then I could use that to answer a question about any city I want.</p>
<p>Okay. Fine. It’s time we talk about <strong><code>group_by()</code>.</strong></p>
</blockquote>
</div>
</div>
</div>
<div id="group_by" class="section level1">
<h1><span class="header-section-number">4</span> | <code>group_by()</code></h1>
<hr>
<div id="the-junk-capital-of-jakku" class="section level2">
<h2><span class="header-section-number">4.1</span> The junk Capital of Jakku</h2>
<blockquote>
<p>Which origin city had the most shipments of junk?</p>
</blockquote>
<p><br></p>
<p>Use <code>group_by</code> with the column <em>origin</em>, and then use<code>summarize</code> to count the <strong>number</strong> of records at each origin city.</p>
<p><br></p>
<p><strong>Fill in the blank</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scrap_shipments &lt;-<span class="st"> </span><span class="kw">group_by</span>(scrap, ______ ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                     </span><span class="kw">summarize</span>(<span class="dt">shipments =</span>  ______ ) </code></pre></div>
<details> <summary class = "btn_code"><em>Show code</em></summary>
<p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">scrap_shipments &lt;-<span class="st"> </span><span class="kw">group_by</span>(scrap, origin ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                     </span><span class="kw">summarize</span>(<span class="dt">shipments =</span>  <span class="kw">n</span>() ) </code></pre></div>
</p>
<p></details></p>
<div class="quiz">
<h3 id="pop-quiz" class="unnumbered">Pop Quiz!</h3>
<p><strong>Which city had the most scrap shipments?</strong></p>
<p><input type="radio"> <em>Tuanul</em> <br> <input type="radio"> <em>Outskirts</em> <br> <input type="radio"> <em>Reestki</em> <br> <input type="radio"> <em>Cratertown</em> <br> <br></p>
<p><details> <summary class = "btn_code"><em>Show solution</em></summary></p>
<p>
<p><i class="fa fa-check" aria-hidden="true" style="color: green;"></i> <code>Cratertown</code></p>
<p><em>You’ve got the POWER!</em></p>
</p>
</details>
</div>
</div>
<div id="bargain-hunters" class="section level2 unnumbered">
<h2>Bargain hunters</h2>
<p>Who’s selling goods for cheap?</p>
<p>Use <code>group_by</code> with the column <em>origin</em>, and then use<code>summarize</code> to find the <code>mean(price_per_unit)</code> at each origin city.</p>
<details> <summary class = "btn_code"><em>Show code</em></summary>
<p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean_prices &lt;-<span class="st"> </span><span class="kw">group_by</span>(scrap, origin) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                 </span><span class="kw">summarize</span>(<span class="dt">mean_price =</span> <span class="kw">mean</span>(price_per_unit, <span class="dt">na.rm =</span> T)) <span class="op">%&gt;%</span>
<span class="st">                 </span><span class="kw">ungroup</span>()</code></pre></div>
</p>
<p></details></p>
<p><br></p>
<p><details> <summary class="btn_code_blue"> EXPLORE: Rounding digits </summary></p>
<div class="note" style="margin-top: -9px;">
<p>
<p>You can round the prices to a certain number of digits using the <code>round()</code> function. We can finish by adding the <code>arrange()</code> function to sort the table by our new column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mean_prices &lt;-<span class="st"> </span><span class="kw">group_by</span>(scrap, origin) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                 </span><span class="kw">summarize</span>(<span class="dt">mean_price       =</span> <span class="kw">mean</span>(price_per_unit, <span class="dt">na.rm =</span> T),
                           <span class="dt">mean_price_round =</span> <span class="kw">round</span>(mean_price, <span class="dt">digits =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">                 </span><span class="kw">arrange</span>(mean_price_round) <span class="op">%&gt;%</span>
<span class="st">                 </span><span class="kw">ungroup</span>()</code></pre></div>
<p><br></p>
<p><strong>Special note</strong></p>
<p>The <code>round()</code> function in R does not automatically round values ending in 5 up. Instead it uses scientific rounding, which rounds values ending in 5 to the nearest even number. So 2.5 rounded to the nearest whole number rounds down to 2, and 3.5 rounded to the nearest whole number rounds up 4.</p>
</p>
</div>
<p></details></p>
<p><br></p>
<div class="tip">
<h3 id="pro-tip" class="unnumbered"><i class="fa fa-user-astronaut" aria-hidden="true" style="color:#040707;"></i> Pro-tip!</h3>
<p>Ending with <code>ungroup()</code> is good practice. This prevents your data from staying grouped after the summarizing has been completed.</p>
</div>
</div>
</div>
<div id="save-files" class="section level1">
<h1><span class="header-section-number">5</span> | Save files</h1>
<hr>
<p>Let’s save the mean price summary table we created to a <em>CSV</em>. That way we can transfer it to a <em>droid courier</em> for delivery to Rey. To save a data frame we use the <code>write_csv()</code> function from our favorite <code>readr</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Write the file to your results folder</span>
<span class="kw">write_csv</span>(mean_prices, <span class="st">&quot;results/prices_by_origin.csv&quot;</span>)</code></pre></div>
<p><br></p>
<div class="red-note">
<h5 id="warning" class="unnumbered"><i class="fas fa-exclamation-triangle" style="color: #040707;"></i> <strong>WARNING!</strong></h5>
<p>By default, when saving files R will overwrite a file if the file already exists in the same folder. It will not ask for confirmation. To be safe, save processed data to a new folder called <code>results/</code> and not to your raw <code>data/</code> folder.</p>
</div>
</div>
<div id="ifelse" class="section level1">
<h1><span class="header-section-number">6</span> | <code>ifelse()</code></h1>
<div id="if-this-thing-is-true-do-this-otherwise-do-this" class="section level3 unnumbered">
<h3><code>[If this thing is true]</code>, <code>&quot;Do this&quot;</code>, <code>&quot;Otherwise do this&quot;</code></h3>
<p><br></p>
<div class="figure">
<img src="images/yoda_lightsaber.jpg" style="width: 46%; margin-left: 26.5%; margin-top: -8px; margin-bottom: 12px;" />

</div>
<p><br></p>
<p>Here’s a handy <code>ifelse</code> statement to help you identify lightsabers.</p>
<div class="well" style="margin-top: 10px:">
<p><code>ifelse(</code><strong>Is lightsaber</strong> <span style="color: green;"><strong>GREEN</strong>?</span>, <strong>Yes!</strong> <code>Then it's Yoda's,</code> <strong>No!</strong> <code>Then it's not Yoda's)</code></p>
</div>
<p><br></p>
<p>Say you want to label all the porgs over <em>60 cm</em> as tall, and everyone else as short. In other words, we want to add a column where the value depends on the value found in the height column. We use <code>ifelse()</code> for this.</p>
<p>Or maybe you have a list of prices for scrap, and you want to flag only the ones that cost less than 500 credits.</p>
</div>
<div id="mutate-ifelse-is-powerful" class="section level2 unnumbered">
<h2><code>mutate()</code> + <code>ifelse()</code> is powerful!</h2>
<div class="figure">
<img src="images/yoda_rise_sm.png" style="width: 74%; margin-left: 12%" />

</div>
<p><br></p>
<div id="on-the-cheap" class="section level3 unnumbered">
<h3>On the cheap</h3>
<p>Bad news. We’re on a budget people. Rey can’t afford anything over 500 credits per item.</p>
<p>Let’s add a column that labels the items as “Cheap” <strong>if</strong> the price is less than 500.</p>
<p><strong>Add an affordable column</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(readr)

<span class="co"># Add an affordable column</span>
scrap &lt;-<span class="st"> </span>scrap <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">         </span><span class="kw">mutate</span>(<span class="dt">affordable =</span> <span class="kw">ifelse</span>(price_per_unit <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>, <span class="st">&quot;Cheap&quot;</span>, <span class="st">&quot;Expensive&quot;</span>))</code></pre></div>
<div class="tip">
<h4 id="exercise-2" class="unnumbered"><i class="fa fa-cogs" aria-hidden="true" style="color: green"></i> EXERCISE</h4>
<p>Use <code>filter()</code> to create a new <code>cheap_scrap</code> table.</p>
</div>
<div class="quiz">
<h3 id="pop-quiz-1" class="unnumbered">Pop Quiz!</h3>
<p><strong>What is the cheapest item?</strong></p>
<p><input type="radio"> <em>Black box</em> <br> <input type="radio"> <em>Electrotelescope</em> <br> <input type="radio"> <em>Atomic drive</em> <br> <input type="radio"> <em>Enviro filter</em> <br> <input type="radio"> <em>Main drive</em> <br> <br></p>
<p><details> <summary class = "btn_code"><em>Show solution</em></summary></p>
<p>
<p><i class="fa fa-check" aria-hidden="true" style="color: green;"></i> <code>Black box</code></p>
<p><em>You win! </em></p>
</p>
</details>
</div>
<p><br></p>
<blockquote>
<p><strong>CONGRATULATIONS</strong> of galactic proportions to you.</p>
<p>We now have a clean and tidy data set. If BB8 receives new data to append, we can re-run this script and in 5 seconds we’ll have cleaned up data again!</p>
</blockquote>
<p><br></p>
</div>
</div>
</div>
<div id="plots-with-ggplot2" class="section level1">
<h1><span class="header-section-number">7</span> | Plots with <em>ggplot2</em></h1>
<hr>
<div id="plot-the-data-plot-the-data-plot-the-data" class="section level4 unnumbered">
<h4><em>Plot the data, Plot the data, Plot the data</em></h4>
<p><br></p>
<div class="figure">
<img src="images/ggplot2_hex.png" align="right" style="margin-right: 70px; margin-top: -124px;" width="180" />

</div>
</div>
<div id="the-ggplot-sandwich" class="section level2 unnumbered">
<h2>The <code>ggplot()</code> sandwich</h2>
<div class="figure">
<img src="images/auto_plot.gif" style="margin-top: -22px; margin-left: -40px; max-width: 110%;" />

</div>
<h5 style="font-size: 28px; font-weight: bold; margin-top: -42px;">
A <code>ggplot</code> has 3 ingredients.
</h5>
</div>
<div id="the-base-plot" class="section level2 unnumbered">
<h2>1. The base plot</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap)</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-19-1.png" width="1056" /></p>
<p><br></p>
<blockquote>
<p>Note when we load the package it’s <code>library (ggplot2)</code>, but the function to make a plot is <code>ggplot(scrap)</code>. We admit, it is a bit silly.</p>
</blockquote>
</div>
<div id="the-the-x-y-aesthetics" class="section level2 unnumbered">
<h2>2. The the X, Y <em>aesthetics</em></h2>
<p>The <em>aesthetics</em> assign the components from the data that you want to use in the chart. These also determine the dimensions of the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits)) </code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-20-1.png" width="1056" /></p>
</div>
<div id="the-layers-or-geometries" class="section level2 unnumbered">
<h2>3. The layers or <em>geometries</em></h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-21-1.png" width="1056" /></p>
<p><br></p>
<div class="tip">
<h4 id="exercise-3" class="unnumbered"><i class="fa fa-cogs" aria-hidden="true" style="color: green"></i> EXERCISE</h4>
<p>Try making a scatterplot of any two columns.</p>
<p><em>Hint: Numeric variables will be more informative.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> __column1__, <span class="dt">y =</span> __column2__)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
</div>
</div>
<div id="colors" class="section level2 unnumbered">
<h2>Colors</h2>
<hr>
<p>Now let’s use color to show the destination of the scrap</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">color =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-23-1.png" width="1056" /></p>
</div>
<div id="columns-charts" class="section level2 unnumbered">
<h2>Columns charts</h2>
<p>Yikes! That point chart had too much detail. Let’s make a column chart and add up the sales to make it easier to understand. Note that we used <code>fill =</code> instead of <code>color =</code>. Try using color instead and see what happens.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">fill =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>()</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-24-1.png" width="1056" /></p>
<p><br></p>
<p>We can change the position of the bars to make it easier to compare sales by destination for each origin. For that we’ll use the – <em>drum roll please</em> – <code>position</code> argument. Remember, you can use <code>help(geom_col)</code> to learn about the different options for that type of plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">fill =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-25-1.png" width="1056" /></p>
<div class="tip">
<h3 id="exercise-4" class="unnumbered"><i class="fa fa-user-bicycle" aria-hidden="true" style="color:#040707;"></i> EXERCISE</h3>
<p>An easy way to experiment with colors is to add layers like <code>+ scale_fill_viridis()</code> or <code>+ scale_fill_brewer()</code> to your plot, which will link to RcolorBrewer so you can have accessible color schemes.</p>
<p>Try adding one of thse to your column plot above.</p>
</div>
</div>
<div id="facet-wrap" class="section level2 unnumbered">
<h2>Facet wrap</h2>
<p>Does the chart feel crowded to you? Let’s use <code>facet wrap</code> to put each origin in a separate chart.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">fill =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;destination&quot;</span>)</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-26-1.png" width="1056" /></p>
</div>
</div>
<div id="its-finn-time" class="section level1">
<h1><span class="header-section-number">8</span> It’s Finn time</h1>
<p>Seriously. Let’s pay that ransom already.</p>
<blockquote>
<p><strong>Where should we go to get our 10,000 Black boxes?</strong></p>
</blockquote>
<p><br></p>
<p><strong>Step 1:</strong> Filter the scrap data to only <code>Black box</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cheap_scrap &lt;-<span class="st"> </span><span class="kw">filter</span>(scrap, ______    <span class="op">==</span><span class="st">   </span>_____   )</code></pre></div>
<p><br></p>
<p><strong>Step 2:</strong> Make a <code>geom_col()</code> plot of the total pounds of Black boxes shipped to each destination.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cheap_scrap, <span class="kw">aes</span>(<span class="dt">x =</span>   , <span class="dt">y =</span>    ) ) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span>geom_</code></pre></div>
<p><details> <summary class = "btn_code"><em>Show code</em></summary></p>
<div class="quiz" style="margin-top: -9px;">
<p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cheap_scrap, <span class="kw">aes</span>(<span class="dt">x =</span> destination, <span class="dt">y =</span> total_pounds) ) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_col</span>()</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-30-1.png" width="1056" /></p>
</p>
</div>
<p></details></p>
<div class="quiz">
<h3 id="pop-quiz-2" class="unnumbered">Pop Quiz!</h3>
<p><strong>Which destination has the most pounds of the cheapest item?</strong></p>
<p><input type="radio"> <em>Trade caravan</em> <br> <input type="radio"> <em>Niima Outpost</em> <br> <input type="radio"> <em>Raiders</em> <br> <br></p>
<p><details> <summary class = "btn_code"><em>Show solution</em></summary></p>
<p>
<p><i class="fa fa-check" aria-hidden="true" style="color: green;"></i> <code>Raiders</code></p>
<p><em>Woop! Go get em! So long Jakku - see you never!</em></p>
</p>
</details>
</div>
<p><br><br></p>
</div>
<div id="concatulations" class="section level1 unnumbered">
<h1><i class="fa fa-star" aria-hidden="true" style="color: gold"></i> CONCATULATIONS! <i class="fa fa-star" aria-hidden="true" style="color: gold"></i></h1>
<hr>
<blockquote>
<p><strong>Clap your hands. You have earned a great award.</strong></p>
</blockquote>
<p><br></p>
</div>
<div id="plot-extras" class="section level1">
<h1><span class="header-section-number">9</span> | Plot extras</h1>
<hr>
<div id="themes" class="section level2 unnumbered">
<h2>Themes</h2>
<p>Want to shake up the appearance of your plots? <code>ggplot2</code> uses <code>theme</code> functions to change the general appearance of a plot. Try some different themes out. Here’s <code>theme_dark()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">fill =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;destination&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_dark</span>()</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-31-1.png" width="1056" /></p>
</div>
<div id="labels" class="section level2 unnumbered">
<h2>Labels</h2>
<p>You can set the axis and title labels using the <code>labs</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">fill =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;destination&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Scrap sales by origin and destination&quot;</span>, 
       <span class="dt">subtitle =</span> <span class="st">&quot;Planet Jakku&quot;</span>,
       <span class="dt">x        =</span> <span class="st">&quot;Origin&quot;</span>, 
       <span class="dt">y        =</span> <span class="st">&quot;Total sales&quot;</span>,
       <span class="dt">caption  =</span> <span class="st">&quot;Data gracefully provided by BB8&quot;</span>)</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-32-1.png" width="1056" /></p>
<p><br></p>
</div>
<div id="drop-1.0e10-scientific-notation" class="section level2 unnumbered">
<h2>Drop <code>1.0e+10</code> scientific notation</h2>
<p>Is your boss scared of scientific notation? To hide it we can use <code>options(scipen = 999)</code>. Note that this is a general setting in R. Once you use <code>options(scipen = 999)</code> in your current session you won’t have to use it again. Like loading a package, you only need to run the line once when you start RStudio.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)

<span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits, <span class="dt">fill =</span> destination)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;destination&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Scrap sales by origin and destination&quot;</span>, 
       <span class="dt">x     =</span> <span class="st">&quot;Origin&quot;</span>, 
       <span class="dt">y     =</span> <span class="st">&quot;Total sales&quot;</span>)</code></pre></div>
<p><img src="03_Day3_files/figure-html/unnamed-chunk-33-1.png" width="1056" /></p>
<p><br></p>
<div class="note">
<p><strong>CHALLENGE</strong></p>
<p>Let’s say we don’t like printing so many zeros and want the labels to be in <strong>Millions</strong> of credits. How can you make it happen?</p>
<p><br></p>
<details><summary> [Click here for a HINT] </summary>
<p>
<p><em>Sorry, the hint is missing. You’re on your own.</em></p>
</p>
<p></details></p>
</div>
<p><br></p>
<div class="tip">
<h3 id="exercise-5" class="unnumbered"><i class="fa fa-bicycle" aria-hidden="true" style="color: green"></i> EXERCISE</h3>
<p>Be brave and make a boxplot. We’ve covered how to do a scatterplot with <code>geom_point</code> and a bar chart with <code>geom_col</code>, but how would you make a boxplot showing the prices at each destination? You’re on your own here. Feel free to add <code>color</code> ,<code>facet_wrap</code>, <code>theme</code>, and <code>labs</code> to your boxplots.</p>
<p><em>May the force be with you.</em></p>
</div>
</div>
<div id="save-plots" class="section level2 unnumbered">
<h2>Save plots</h2>
<p>You’ve hopefully made some plots you’re proud of, so let’s learn to save them so we can cherish them forever. There’s a function called <code>ggsave</code> to do just that. How do we <code>ggsave</code> our plots? HELP! Let’s type <code>help(ggsave)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get help</span>
<span class="kw">help</span>(ggsave)
?ggsave

<span class="co"># Copy and paste the r code of your favorite plot here</span>
<span class="kw">ggplot</span>(data, <span class="kw">aes</span>()) <span class="op">+</span>
<span class="st">   </span>.... <span class="op">+</span>
<span class="st">   </span>....


<span class="co"># Save your plot to a png file of your choosing</span>
<span class="kw">ggsave</span>(<span class="st">&quot;your_results_folder/plot_name.png&quot;</span>)</code></pre></div>
<p><br></p>
<div id="pro-tip-1" class="section level3 unnumbered">
<h3><i class="fa fa-user-astronaut" aria-hidden="true" style="color:#040707;"></i> Pro-tip!</h3>
<div class="note">
<p>Sometimes you may want to make a plot and save it for later. For that, you give your plot a name. Any name will do.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The ggplot you want to save</span>
my_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(...)
  
<span class="co"># The name of the file the chart will be saved to.</span>
where_to_save_it &lt;-<span class="st"> &quot;___.png&quot;</span>

<span class="co"># Save it!</span>
<span class="kw">ggsave</span>(<span class="dt">filename =</span> where_to_save_it, <span class="dt">plot =</span> my_plot)</code></pre></div>
<p><br></p>
<p><em>Learn more about saving plots at</em> <a href="http://stat545.com/block017_write-figure-to-file.html">http://stat545.com/</a></p>
<p><br></p>
</div>
</div>
</div>
</div>
<div id="glossary" class="section level1">
<h1><span class="header-section-number">10</span> | Glossary</h1>
<p><strong>Table of <code>aesthetics</code></strong></p>
<table>
<thead>
<tr class="header">
<th align="left">aes()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>x =</code></td>
</tr>
<tr class="even">
<td align="left"><code>y =</code></td>
</tr>
<tr class="odd">
<td align="left"><code>alpha =</code></td>
</tr>
<tr class="even">
<td align="left"><code>fill =</code></td>
</tr>
<tr class="odd">
<td align="left"><code>color =</code></td>
</tr>
<tr class="even">
<td align="left"><code>size =</code></td>
</tr>
<tr class="odd">
<td align="left"><code>linetype =</code></td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>Table of <code>geoms</code></strong></p>
<div class="figure">
<img src="images/geoms_1var.png" />

</div>
<div class="figure">
<img src="images/geoms_diagram.png" />

</div>
<p><br></p>
<p><strong>Table of <code>themes</code></strong></p>
<p>You can customize the look of your plot by adding a <code>theme()</code> function.</p>
<div class="figure">
<img src="images/ggplot_themes.png" />

</div>
</div>
<div id="homeworld-training" class="section level1 unnumbered">
<h1>Homeworld training</h1>
<div class="figure">
<img src="images/porg.png" style="float: right; margin-top: -34px;" />

</div>
<ol style="list-style-type: decimal">
<li>Load one of the data sets below into R
<ul>
<li>Porg contamination on Ahch-To
<ul>
<li><code>https://rtrain.netlify.com/data/porg_samples.csv</code></li>
</ul></li>
<li>Planet Endor air samples
<ul>
<li><code>https://rtrain.netlify.com/data/air_endor.csv</code></li>
</ul></li>
<li>Or use data from a recent project of yours</li>
</ul></li>
<li><p>Create 2 plots using the data.</p></li>
<li><p><em>If you make something really</em> <strong>strange</strong>. <em>Feel free to share! Consider it art and keep going.</em></p></li>
</ol>
<div class="note">
<h3 id="pro-tip-2" class="unnumbered"><i class="fa fa-user-astronaut" aria-hidden="true" style="color:#040707;"></i> Pro-tip!</h3>
<p>When you add more layers using <code>+</code> remember to place it at the end of each line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This will work</span>
<span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()

<span class="co"># So will this</span>
<span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()

<span class="co"># But this won&#39;t</span>
<span class="kw">ggplot</span>(scrap, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">y =</span> credits))
  <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
</div>
<p><br><br></p>
<details> <summary class = "btn_code">
<h4>
<i class="far fa-question-circle" aria-hidden="true"></i> Plots Q+A
</h4>
</summary>
<div class="quiz" style="margin-top: -9px; background-color: white; font-size: 16px;">
<p>
<p><br></p>
<ul>
<li>How to modify the gridlines behind your chart?
<ul>
<li>Try the different themes at the end of this lesson: <code>theme_light()</code> or <code>theme_bw()</code></li>
<li>Or modify the color and size with <code>theme(panel.grid.minor = element_line(colour = &quot;white&quot;, size = 0.5))</code></li>
<li>There’s even <code>theme_excel()</code></li>
</ul></li>
<li>How do you set the x and y scale manually?
<ul>
<li>Here is an example with a scatter plot: <code>ggplot() + geom_point() + xlim(beginning, end) + ylim(beginning, end)</code></li>
<li><strong>Warning:</strong> Values above or below the limits you set will not be shown. This is another great way to lie with data.</li>
</ul></li>
<li>How do you get rid of the legend if you don’t need it?
<ul>
<li><code>geom_point(aes(color = facility_name), show.legend = FALSE)</code></li>
<li>The <a href="http://www.cookbook-r.com/Graphs/Legends_(ggplot2)/">R Cookbook</a> shows a number of ways to get rid of legends.</li>
</ul></li>
<li>I only like dashed lines. How do you change the linetype to a <em>dashed</em> line?
<ul>
<li><code>geom_line(aes(color = facility_name), linetype = &quot;dashed&quot;)</code></li>
<li>You can also try <code>&quot;dotted&quot;</code> and <code>&quot;dotdash&quot;</code>, or even<code>&quot;twodash&quot;</code></li>
</ul></li>
<li>How many colors are there in R? How does R know <code>hotpink</code> is a color?
<ul>
<li>There is an <a href="https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf">R color cheatsheet</a><br />
</li>
<li>As well as a list of <a href="http://www.r-graph-gallery.com/42-colors-names/">R color names</a></li>
<li><code>library(viridis)</code> provides some great default color palettes for charts and maps.</li>
<li>This <a href="http://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">Color web tool</a> has palette ideas and color codes you can use in your plots</li>
</ul></li>
<li>Keyboard shortcuts for RStudio
<ul>
<li>There is a <a href="https://www.rstudio.com/wp-content/uploads/2016/01/rstudio-IDE-cheatsheet.pdf">Shortcut cheatsheet</a></li>
<li>In RStudio you can go to <em>Help</em> &gt; <em>Keyboard Shortcuts Help</em></li>
</ul></li>
</ul>
</p>
</div>
<p></details></p>
<p><br></p>
</div>
<div id="return-to-homebase" class="section level1 unnumbered">
<h1><i class="fa fa-rocket" aria-hidden="true"></i> Return to <a href="index.html">Homebase</a></h1>
<p><br></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
